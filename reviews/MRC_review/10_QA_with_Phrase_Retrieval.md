# ğŸ“˜ 10ê°•. QA with Phrase Retrieval

## ğŸ”¹ ì£¼ì œ
ì „ì²´ ë¬¸ì„œê°€ ì•„ë‹Œ **êµ¬ë¬¸(Phrase)** ë‹¨ìœ„ë¡œ ê²€ìƒ‰í•˜ì—¬ ì§ˆë¬¸ì— ë‹µí•˜ëŠ” **ì˜¤í”ˆ ë„ë©”ì¸ ì§ˆë¬¸ë‹µë³€(ODQA)** ì‹œìŠ¤í…œ ì„¤ê³„

## ğŸ§© í•µì‹¬ ìš”ì•½

| êµ¬ë¶„ | ì£¼ìš” ë‚´ìš© | í”„ë¡œì íŠ¸ ì ìš© í¬ì¸íŠ¸ |
|------|------------|----------------------|
| **Phrase Retrieval** | ë¬¸ì„œ ë‹¨ìœ„ê°€ ì•„ë‹Œ Phrase ë‹¨ìœ„ë¡œ ê²€ìƒ‰ | ë°ì´í„° ë‹¨ìœ„ ë¶„í• /ê²€ìƒ‰ ìµœì í™” ì„¤ê³„ |
| **Dense + Sparse ê²°í•©** | ì˜ë¯¸ì  + ì–´íœ˜ì  ì •ë³´ ê²°í•© | ì˜ë¯¸ ê¸°ë°˜ ì§ˆì˜ì‘ë‹µ ì‹œìŠ¤í…œ êµ¬ì¶• |
| **FAISS ê¸°ë°˜ ê²€ìƒ‰** | ëŒ€ê·œëª¨ ë°ì´í„° íš¨ìœ¨ì  ê²€ìƒ‰ | ë°±ì—”ë“œ ê²€ìƒ‰ ì—”ì§„ êµ¬í˜„ ì‹œ í™œìš© |
| **DensePhrases/ColBERT** | ìµœì‹  íš¨ìœ¨ì  ê²€ìƒ‰ ëª¨ë¸ | ëª¨ë¸ ê²½ëŸ‰í™” ë° ì‹¤ì‹œê°„ ì‘ë‹µ ì„¤ê³„ |
| **Decomposability Gap í•´ê²°** | Question-Answer ê°„ attention ë³µì› | ì¸ì½”ë”© êµ¬ì¡° ì„¤ê³„ ì°¸ê³  |

---

## ğŸ§© 1. Phrase Retrieval in Open-Domain Question Answering

### ğŸ”¸ ê¸°ì¡´ Retriever-Reader ë°©ì‹ì˜ í•œê³„
1. **Error Propagation**
   - ìƒìœ„ 5~10ê°œ ë¬¸ì„œë§Œ Readerì— ì „ë‹¬ë˜ì–´ **ì´ˆê¸° ê²€ìƒ‰ ì˜¤ë¥˜ê°€ ì „íŒŒë¨**  
2. **Query-dependent Encoding**
   - ì§ˆë¬¸ì— ë”°ë¼ **ë‹µë³€ ìŠ¤íŒ¬ì˜ ì¸ì½”ë”©ì´ ë‹¬ë¼ì ¸** ì¼ê´€ì„± ìˆëŠ” ê²€ìƒ‰ ì–´ë ¤ì›€

### ğŸ”¸ í•´ê²°ì±…: Phrase Retrieval
- ë¬¸ì„œë¥¼ **ë¬¸êµ¬(Phrase)** ë‹¨ìœ„ë¡œ ë¶„í•´í•˜ê³ , ê° phraseë¥¼ ë…ë¦½ì ìœ¼ë¡œ ë²¡í„°í™”  
- ì§ˆë¬¸ë„ ë²¡í„°ë¡œ ë³€í™˜í•˜ì—¬ **Nearest Neighbor Search (NNS)** ìˆ˜í–‰ â†’ ê°€ì¥ ìœ ì‚¬í•œ êµ¬ë¬¸ ë°˜í™˜  
- **Query-Agnostic Decomposition**
  - ì§ˆë¬¸ê³¼ ë¬´ê´€í•˜ê²Œ **ëª¨ë“  ë¬¸êµ¬ë¥¼ ë¯¸ë¦¬ ì¸ë±ì‹±**
  - ì§ˆë¬¸ì´ ë“¤ì–´ì˜¤ë©´ ë²¡í„° ê³µê°„ì—ì„œ ì§ì ‘ ê²€ìƒ‰  

> âœ… **í•µì‹¬ ì•„ì´ë””ì–´:**  
> â€œRetrieve â†’ Readâ€ ë‘ ë‹¨ê³„ë¥¼ ê±°ì¹˜ì§€ ì•Šê³ , **â€˜ì •ë‹µ êµ¬ë¬¸â€™ì„ ë°”ë¡œ ê²€ìƒ‰**

---

## ğŸ§  2. Dense-sparse Representation for Phrases

### ğŸ”¸ Dense vs Sparse í‘œí˜„
| êµ¬ë¶„ | Dense í‘œí˜„ | Sparse í‘œí˜„ |
|------|-------------|-------------|
| íŠ¹ì§• | ì˜ë¯¸ì /í†µì‚¬ì  ì •ë³´ í‘œí˜„ | ì–´íœ˜ì (lexical) ì •ë³´ í‘œí˜„ |
| ì˜ˆì‹œ | BERT, SpanBERT | TF-IDF, BM25 |
| ì¥ì  | ë¬¸ë§¥ ì´í•´ì— ê°•í•¨ | ë‹¨ì–´ ê¸°ë°˜ ì •í•©ì— ê°•í•¨ |

> ë‘ ë°©ì‹ì„ **ê²°í•©(Dense + Sparse)** í•˜ë©´ ë¬¸ë§¥ê³¼ ë‹¨ì–´ ì •í•©ì„ ëª¨ë‘ ê³ ë ¤ ê°€ëŠ¥

---

### ğŸ”¸ Phrase & Question Embedding
- Phraseì™€ Questionì„ ê°ê° ì„ë² ë”©  
- Dense í‘œí˜„ì€ **BERT ê¸°ë°˜**, Sparse í‘œí˜„ì€ **n-gram ê°€ì¤‘ì¹˜ ê¸°ë°˜**

### ğŸ”¸ Dense Representation (DenSPI, 2019)
- BERT ê¸°ë°˜ **Start/End ë²¡í„° ì¬ì‚¬ìš©**ìœ¼ë¡œ ë©”ëª¨ë¦¬ íš¨ìœ¨í™”  
- **Coherency Vector** ì¶”ê°€ë¡œ â€œì™„ì „í•œ êµ¬ë¬¸(Phrase)â€ë§Œ í•„í„°ë§  
- Questionì€ **[CLS] í† í° ì„ë² ë”©**ìœ¼ë¡œ í‘œí˜„

### ğŸ”¸ Sparse Representation
- ë¬¸ë§¥í™”ëœ ì„ë² ë”©ì„ ì‚¬ìš©í•´ **ê°€ì¥ ê´€ë ¨ì„± ë†’ì€ n-gram** ì„ íƒ  
- Sparse Vector êµ¬ì„± ì‹œ ì˜ë¯¸ ì†ì‹¤ ìµœì†Œí™”

---

### âš™ï¸ Scalability Challenge
- Wikipedia ê¸°ì¤€ **60B(600ì–µ ê°œ) phrase** ì¡´ì¬ â†’ ì €ì¥ ë° ê²€ìƒ‰ ë¬¸ì œ
- í•´ê²° ë°©ë²•:
  - **Storage**: Pointer + Scalar Quantization (240TB â†’ 1.4TBë¡œ ê°ì†Œ)
  - **Search**: **FAISS**ë¡œ Dense search í›„ Sparse reranking ìˆ˜í–‰

---

### ğŸ”¸ DensePhrases (2021)
- **SpanBERT ë‘ ê°œ ì‚¬ìš©**: ê°ê° Start/End ì„ë² ë”© ê³„ì‚°  
- Sparse ì„ë² ë”© ì œê±° â†’ ì €ì¥ ê³µê°„ ì ˆê°  
- Retriever-reader ì„±ëŠ¥ê³¼ ìœ ì‚¬í•œ ìˆ˜ì¤€ ë„ë‹¬

### ğŸ”¸ ColBERT (2020)
- **Late Interaction ë°©ì‹**
  - Queryì™€ ë¬¸ì„œë¥¼ **ë¶„ë¦¬ ì¸ì½”ë”©** â†’ ë¯¸ë¦¬ ë¬¸ì„œ ì„ë² ë”© êµ¬ì¶• ê°€ëŠ¥  
- **MaxSim ì—°ì‚°**ìœ¼ë¡œ ë¹ ë¥¸ ê²€ìƒ‰  
- íš¨ìœ¨ì ì´ê³  ëŒ€ê·œëª¨ ì²˜ë¦¬ì— ì í•©  

---

## ğŸ“Š 3. Experiment Results & Analysis

### ğŸ”¸ DenSPI ê²°ê³¼ (SQuAD-open)
- Retriever-Readerë³´ë‹¤ **+3.6% ì •í™•ë„ í–¥ìƒ**
- **68ë°° ë¹ ë¥¸ ì¶”ë¡  ì†ë„ (CPU ê¸°ì¤€ <1s)**  
- ë‹¨ì :
  - 2TB SSD í•„ìš” (ì €ì¥ ê³µê°„ í¼)
  - **Decomposability Gap** ë¬¸ì œë¡œ ì •í™•ë„ í•˜ë½  
    - Questionê³¼ Answerê°€ ë¶„ë¦¬ ì¸ì½”ë”©ë˜ë©° Attention ì†ì‹¤  
    - BERT(90.9) â†’ DenSPI(81.7)

### ğŸ”¸ DensePhrases ê²°ê³¼
- Decomposability Gap í•´ì†Œ  
- Sparse Embedding ì œê±°ë¡œ **Storage ë¬¸ì œ ì™„í™”**
- **Retriever-Reader ìˆ˜ì¤€ì˜ ì„±ëŠ¥ íšŒë³µ**
- DPRê³¼ ë¹„êµ ì‹œ:
  - **20ë°° ë¹ ë¥¸ ì†ë„**
  - **ìœ ì‚¬í•œ ì •í™•ë„** í™•ë³´  

---

## ğŸš€ ì •ë¦¬ ë° ì¸ì‚¬ì´íŠ¸

- **Phrase Retrieval**ì€ ODQAì˜ ì†ë„ì™€ íš¨ìœ¨ì„±ì„ ê·¹ëŒ€í™”í•œ ë°©ì‹  
- DensePhrasesëŠ” **ì„±ëŠ¥Â·ì €ì¥Â·ì†ë„** ëª¨ë‘ ê°œì„ ëœ ì°¨ì„¸ëŒ€ ë°©ì‹  
- **FAISS, BERT, SpanBERT, Dense/Sparse Hybrid** ë“±ì€  
  â†’ ê°œì¸ í”„ë¡œì íŠ¸ì—ì„œ **ëŒ€ìš©ëŸ‰ ê²€ìƒ‰ì—”ì§„ ì„¤ê³„ ë˜ëŠ” ì§ˆì˜ì‘ë‹µ ì‹œìŠ¤í…œ êµ¬ì¶• ì‹œ** í•µì‹¬ ì°¸ê³  ê¸°ìˆ   

---
